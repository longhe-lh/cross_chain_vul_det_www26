{"project": "ICICB Bridge", "functions": ["function deposit(address _token, uint _amount, uint _targetChain) external override payable {\n\t\taddress _account = msg.sender;\n\t\tuint256 size;\n assembly {size := extcodesize(_account)}\n\t\trequire(size==0, \"bridge: only personal\");\n\t\trequire(_account!=address(0), \"bridge: zero sender\");\n\t\tif (_token==address(0)) {\n\t\t\trequire(msg.value==_amount, \"bridge: amount\");\n\t\t} else {\n\t\t\tbool isPegged = tokenIndexes[_token]!=0;\n\t\t\tif (isPegged) {\n\t\t\t\tIRC20(_token).burnFrom(_account, _amount);\n\t\t\t} else {\n\t\t\t\tIRC20(_token).transferFrom(_account, address(this), _amount);\n\t\t\t}\n\t\t}\n\t\temit Deposit(_token, _account, _amount, _targetChain);\n\t}", "function withdraw(uint wad) public payable {\n require(balanceOf[msg.sender] >= wad);\n balanceOf[msg.sender] -= wad;\n function transfer(...) {...}\npayable(msg.sender).transfer(wad);\n emit Withdrawal(msg.sender, wad);\n }", "function swapToVUsd(address user, uint256 amount) external onlyRouter returns (uint256) {\n        uint256 result; \n        uint256 fee;\n        if (amount > 0) {\n            fee = amount * feeShareBP / BP;\n            uint256 amountIn = toSystemPrecision(amount - fee);\n            \n            fee = amount - fromSystemPrecision(amountIn);\n            tokenBalance += amountIn;\n            uint256 vUsdNewAmount = this.getY(tokenBalance);\n            if (vUsdBalance > vUsdNewAmount) {\n                result = vUsdBalance - vUsdNewAmount;\n            }\n            vUsdBalance = vUsdNewAmount;\n            token.safeTransferFrom(user, address(this), amount);\n            _addRewards(fee);\n        }\n        emit SwappedToVUsd(user, address(token), amount, result, fee);\n        return result;\n    }"], "label": "Yes", "detail": "The attacker took out a 7.5 million BUSD flash loan, then made large deposits and swaps in the BUSD–vUSD and USDT–vUSD pools to manipulate exchange rates. They then swapped assets in the reverse direction to gain profits of approximately 550,000 BUSD before repaying the flash loan."}