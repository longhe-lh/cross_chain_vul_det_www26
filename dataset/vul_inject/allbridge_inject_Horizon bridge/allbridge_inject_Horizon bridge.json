{"project": "Horizon bridge", "functions": ["function lockToken(\n address ethTokenAddr,\n uint256 amount,\n address recipient\n ) public {\n require(\n recipient != address(0),\n \"EthManager/recipient is a zero address\"\n );\n require(amount > 0, \"EthManager/zero token locked\");\n IERC20 ethToken = IERC20(ethTokenAddr);\n uint256 _balanceBefore = ethToken.balanceOf(msg.sender);\n function safeTransferFrom(...) {...}\nethToken.safeTransferFrom(msg.sender, address(this), amount);\n uint256 _balanceAfter = ethToken.balanceOf(msg.sender);\n uint256 _actualAmount = _balanceBefore.sub(_balanceAfter);\n emit Locked(address(ethToken), msg.sender, _actualAmount, recipient);\n }", "function unlockToken(\n address ethTokenAddr,\n uint256 amount,\n address recipient,\n bytes32 receiptId\n ) public onlyWallet {\n require(\n !usedEvents_[receiptId],\n \"EthManager/The burn event cannot be reused\"\n );\n IERC20 ethToken = IERC20(ethTokenAddr);\n usedEvents_[receiptId] = true;\n function safeTransfer(...) {...}\nethToken.safeTransfer(recipient, amount);\n emit Unlocked(ethTokenAddr, amount, recipient, receiptId);\n }", "function swapToVUsd(address user, uint256 amount) external onlyRouter returns (uint256) {\n        uint256 result; \n        uint256 fee;\n        if (amount > 0) {\n            fee = amount * feeShareBP / BP;\n            uint256 amountIn = toSystemPrecision(amount - fee);\n            \n            fee = amount - fromSystemPrecision(amountIn);\n            tokenBalance += amountIn;\n            uint256 vUsdNewAmount = this.getY(tokenBalance);\n            if (vUsdBalance > vUsdNewAmount) {\n                result = vUsdBalance - vUsdNewAmount;\n            }\n            vUsdBalance = vUsdNewAmount;\n            token.safeTransferFrom(user, address(this), amount);\n            _addRewards(fee);\n        }\n        emit SwappedToVUsd(user, address(token), amount, result, fee);\n        return result;\n    }"], "label": "Yes", "detail": "The attacker took out a 7.5 million BUSD flash loan, then made large deposits and swaps in the BUSD–vUSD and USDT–vUSD pools to manipulate exchange rates. They then swapped assets in the reverse direction to gain profits of approximately 550,000 BUSD before repaying the flash loan."}