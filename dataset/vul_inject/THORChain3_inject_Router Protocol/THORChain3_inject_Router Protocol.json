{"project": "Router Protocol", "functions": ["function cancelProposal(\n uint8 chainID,\n uint64 depositNonce,\n bytes32 dataHash\n ) public onlyAdminOrRelayer whenNotPaused{\n bytes32 proposalHash = keccak256(abi.encodePacked(chainID, depositNonce, dataHash));\n IVoterUpgradeable.ProposalStatus currentStatus = _voter.getStatus(_proposals[proposalHash]);\n require(\n currentStatus == IVoterUpgradeable.ProposalStatus.Active ||\n currentStatus == IVoterUpgradeable.ProposalStatus.Passed,\n \"Proposal cannot be cancelled\"\n );\n _voter.setStatus(_proposals[proposalHash]);\n currentStatus = _voter.getStatus(_proposals[proposalHash]);\n emit ProposalEvent(chainID, depositNonce, currentStatus, dataHash);\n }", "function returnVaultAssets(address router, address payable asgard, Coin[] memory coins, string memory memo) external payable {\n        if (router == address(this)){\n            for(uint i = 0; i < coins.length; i++){\n                _adjustAllowances(asgard, coins[i].asset, coins[i].amount);\n            }\n            emit VaultTransfer(msg.sender, asgard, coins, memo); \n        } else {\n            for(uint i = 0; i < coins.length; i++){\n                _routerDeposit(router, asgard, coins[i].asset, coins[i].amount, memo);\n            }\n        }\n        (bool success, bytes memory data) = asgard.call{value:msg.value}(\"\"); \n        require(success && (data.length == 0 || abi.decode(data, (bool))));\n    }"], "label": "Yes", "detail": "The attacker deployed a malicious contract and used the THORChain Router's `returnVaultAssets` function to send ETH to the malicious contract, falsely setting the contract as an Asgard vault. The malicious contract triggered the `deposit` event and allowed the attacker to arbitrarily craft the `asset` and `amount` parameters, along with an invalid `memo`. This invalid `memo` disrupted the THORChain node's processing logic, forcing it into the refund logic path. Because the refund logic didnâ€™t properly validate the entire transaction, the attacker was able to gain profits without transferring any legitimate value."}