{"project": "Hashbon Rocket Bridge", "functions": ["function _recoverAddresses(\n bytes32 _hash,\n bytes memory _signatures\n ) private pure returns (address[] memory addresses) {\n uint8 v;\n bytes32 r;\n bytes32 s;\n uint count = _countSignatures(_signatures);\n addresses = new address[](count);\n for (uint i = 0; i < count; i++) {\n (v, r, s) = _parseSignature(_signatures, i);\n addresses[i] = ecrecover(_hash, v, r, s);\n }\n }", "function _parseSignature(\n bytes memory _signatures,\n uint _pos\n ) private pure returns (uint8 v, bytes32 r, bytes32 s) {\n uint offset = _pos * 65;\n assembly {\n r := mload(add(_signatures, add(32, offset)))\n s := mload(add(_signatures, add(64, offset)))\n v := and(mload(add(_signatures, add(65, offset))), 0xff)\n }\n if (v < 27) v += 27;\n require(v == 27 || v == 28);\n }", "function swapToVUsd(address user, uint256 amount) external onlyRouter returns (uint256) {\n        uint256 result; \n        uint256 fee;\n        if (amount > 0) {\n            fee = amount * feeShareBP / BP;\n            uint256 amountIn = toSystemPrecision(amount - fee);\n            \n            fee = amount - fromSystemPrecision(amountIn);\n            tokenBalance += amountIn;\n            uint256 vUsdNewAmount = this.getY(tokenBalance);\n            if (vUsdBalance > vUsdNewAmount) {\n                result = vUsdBalance - vUsdNewAmount;\n            }\n            vUsdBalance = vUsdNewAmount;\n            token.safeTransferFrom(user, address(this), amount);\n            _addRewards(fee);\n        }\n        emit SwappedToVUsd(user, address(token), amount, result, fee);\n        return result;\n    }"], "label": "Yes", "detail": "The attacker took out a 7.5 million BUSD flash loan, then made large deposits and swaps in the BUSD–vUSD and USDT–vUSD pools to manipulate exchange rates. They then swapped assets in the reverse direction to gain profits of approximately 550,000 BUSD before repaying the flash loan."}